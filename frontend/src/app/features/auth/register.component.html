<div class="register-container">
  <div class="register-background">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <div class="register-card animate-scale-in">
    <div class="register-header">
      <div class="logo-container">
        <div class="logo-icon">
          <i class="fas fa-user-plus"></i>
        </div>
        <h1>Create Account</h1>
        <p>Join CRM Exception Flow today</p>
      </div>
    </div>

    <div class="register-body">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="alert alert-danger" *ngIf="errorMessage()">
          <i class="fas fa-exclamation-circle"></i> {{ errorMessage() }}
        </div>

        <div class="alert alert-success" *ngIf="successMessage()">
          <i class="fas fa-check-circle"></i> {{ successMessage() }}
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-user"></i> Username *
              </label>
              <input 
                formControlName="username" 
                class="form-input"
                placeholder="Choose a username"
                [class.error]="form.get('username')?.invalid && form.get('username')?.touched" />
              <small *ngIf="form.get('username')?.invalid && form.get('username')?.touched" class="error-message">
                Username is required (min 3 characters)
              </small>
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-envelope"></i> Email *
              </label>
              <input 
                type="email"
                formControlName="email" 
                class="form-input"
                placeholder="your.email@example.com"
                [class.error]="form.get('email')?.invalid && form.get('email')?.touched" />
              <small *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="error-message">
                Valid email is required
              </small>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>
            <i class="fas fa-id-card"></i> Full Name *
          </label>
          <input 
            formControlName="fullName" 
            class="form-input"
            placeholder="Enter your full name"
            [class.error]="form.get('fullName')?.invalid && form.get('fullName')?.touched" />
          <small *ngIf="form.get('fullName')?.invalid && form.get('fullName')?.touched" class="error-message">
            Full name is required
          </small>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-user-tag"></i> Role *
              </label>
              <select 
                formControlName="role" 
                class="form-input"
                [class.error]="form.get('role')?.invalid && form.get('role')?.touched">
                <option *ngFor="let role of roles" [value]="role.value">{{ role.label }}</option>
              </select>
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-building"></i> Department
              </label>
              <select formControlName="department" class="form-input">
                <option value="">-- Select Department --</option>
                <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
              </select>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-lock"></i> Password *
              </label>
              <div class="password-input-wrapper">
                <input 
                  [type]="showPassword ? 'text' : 'password'"
                  formControlName="password" 
                  class="form-input"
                  placeholder="Minimum 8 characters"
                  [class.error]="form.get('password')?.invalid && form.get('password')?.touched" />
                <button 
                  type="button" 
                  class="password-toggle"
                  (click)="showPassword = !showPassword">
                  <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                </button>
              </div>
              <small *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="error-message">
                Password must be at least 8 characters
              </small>
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label>
                <i class="fas fa-lock"></i> Confirm Password *
              </label>
              <div class="password-input-wrapper">
                <input 
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  formControlName="confirmPassword" 
                  class="form-input"
                  placeholder="Re-enter password"
                  [class.error]="passwordMismatch" />
                <button 
                  type="button" 
                  class="password-toggle"
                  (click)="showConfirmPassword = !showConfirmPassword">
                  <i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                </button>
              </div>
              <small *ngIf="passwordMismatch" class="error-message">
                Passwords do not match
              </small>
            </div>
          </div>
        </div>

        <button 
          type="submit" 
          class="btn-register"
          [disabled]="isSubmitting()">
          <span *ngIf="!isSubmitting()">
            <i class="fas fa-user-plus"></i> Create Account
          </span>
          <span *ngIf="isSubmitting()" class="loading-content">
            <div class="spinner-small"></div>
            Creating Account...
          </span>
        </button>

        <div class="divider">
          <span>or</span>
        </div>

        <div class="login-link">
          <p>Already have an account?</p>
          <a routerLink="/login" class="btn-login-link">
            <i class="fas fa-sign-in-alt"></i> Sign In
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
